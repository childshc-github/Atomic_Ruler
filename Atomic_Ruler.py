# formatted Lovell rotamer library originally pulled from:
# https://github.com/donaldlab/OSPREY3/blob/main/src/main/resources/edu/duke/cs/osprey/gui/conflib/lovell.conflib
# use v2RotamerConverter to convert GUI v2-> Atomic_Ruler format for distance calculation

import math
from collections import OrderedDict

# NOTE: CB must have index 0
# Phenylalanine (test: only checking 1 conformation)
Phe = OrderedDict()
Phe['CB'] = [30.817000, 36.055000, 42.019000]
#Phe['H'] = [11.835000, 14.174000, 21.993000]
Phe['HA'] = [30.441000, 36.696000, 44.047000]
Phe['HB2'] = [30.271024, 35.112041, 42.168177]
Phe['HB3'] = [30.101633, 36.778267, 41.600155]
Phe['CG'] = [31.919772, 35.827350, 41.022723]
Phe['CD1'] = [32.554395, 34.593196, 40.937063]
Phe['HD1'] = [32.247293, 33.776445, 41.607208]
Phe['CE1'] = [33.574131, 34.377973, 40.013632]
Phe['HE1'] = [34.067911, 33.396367, 39.957848]
Phe['CZ'] = [33.967160, 35.403837, 39.163083]
Phe['HZ'] = [34.771937, 35.236849, 38.432540]
Phe['CE2'] = [33.340349, 36.640725, 39.239335]
Phe['HE2'] = [33.647419, 37.456605, 38.568698]
Phe['CD2'] = [32.321356, 36.846761, 40.166773]
Phe['HD2'] = [31.828382, 37.828637, 40.222028]

# Tryptophan (7 conformations)
Trp1 = OrderedDict()
Trp1['CB'] = [51.342, 33.914, 10.337]
#Trp1['H'] = [11.835, 14.174, 21.993]
Trp1['HA'] = [51.629, 33.217, 12.35]
Trp1['HB2'] = [52.424684, 33.930809, 10.143476]
Trp1['HB3'] = [50.970473, 32.934357, 10.000952]
Trp1['CG'] = [50.685648, 34.988956, 9.518717]
Trp1['CD1'] = [49.429658, 34.96012, 8.983856]
Trp1['HD1'] = [48.721587, 34.12538, 9.08695]
Trp1['NE1'] = [49.177872, 36.124231, 8.297948]
Trp1['HE1'] = [48.327819, 36.343737, 7.819009]
Trp1['CE2'] = [50.280208, 36.934198, 8.376827]
Trp1['CZ2'] = [50.50337, 38.20768, 7.843457]
Trp1['HZ2'] = [49.731049, 38.722792, 7.253142]
Trp1['CH2'] = [51.721417, 38.79062, 8.083932]
Trp1['HH2'] = [51.927392, 39.792665, 7.678557]
Trp1['CZ3'] = [52.712866, 38.136227, 8.837397]
Trp1['HZ3'] = [53.679087, 38.632603, 9.007707]
Trp1['CE3'] = [52.490489, 36.870187, 9.370685]
Trp1['HE3'] = [53.268951, 36.365454, 9.961742]
Trp1['CD2'] = [51.254013, 36.250059, 9.139874]

Trp2 = OrderedDict()
Trp2['CB'] = [51.342, 33.914, 10.337]
Trp2['CD2'] = [51.254013, 36.250059, 9.139874]
#Trp2['H'] = [11.835, 14.174, 21.993]
Trp2['HA'] = [51.629, 33.217, 12.35]
Trp2['HB2'] = [52.424684, 33.930809, 10.143476]
Trp2['HB3'] = [50.970473, 32.934357, 10.000952]
Trp2['CG'] = [50.685648, 34.988956, 9.518717]
Trp2['CD1'] = [51.225301, 36.190988, 9.160512]
Trp2['HD1'] = [52.234168, 36.533093, 9.432423]
Trp2['NE1'] = [50.326161, 36.911833, 8.411545]
Trp2['HE1'] = [50.486203, 37.822408, 8.030238]
Trp2['CE2'] = [49.175754, 36.180596, 8.272734]
Trp2['CZ2'] = [47.98728, 36.488075, 7.602638]
Trp2['HZ2'] = [47.861341, 37.444109, 7.07308]
Trp2['CH2'] = [46.984307, 35.552893, 7.630298]
Trp2['HH2'] = [46.037188, 35.764672, 7.11168]
Trp2['CZ3'] = [47.139615, 34.329158, 8.30651]
Trp2['HZ3'] = [46.313026, 33.604097, 8.310282]
Trp2['CE3'] = [48.322909, 34.021435, 8.971211]
Trp2['HE3'] = [48.438913, 33.061235, 9.495296]
Trp2['CD2'] = [49.365136, 34.959699, 8.959848]

Trp3 = OrderedDict()
Trp3['CB'] = [51.342, 33.914, 10.337]
Trp3['CD2'] = [49.365136, 34.959699, 8.959848]
#Trp3['H'] = [11.835, 14.174, 21.993]
Trp3['HA'] = [51.629, 33.217, 12.35]
Trp3['HB2'] = [50.895597, 32.972156, 9.985442]
Trp3['HB3'] = [50.813769, 34.731453, 9.823771]
Trp3['CG'] = [52.789371, 33.944527, 9.936876]
Trp3['CD1'] = [53.455938, 34.98199, 9.350551]
Trp3['HD1'] = [53.006446, 35.951054, 9.090444]
Trp3['NE1'] = [54.769266, 34.640762, 9.13202]
Trp3['HE1'] = [55.46102, 35.230977, 8.715754]
Trp3['CE2'] = [54.976241, 33.361353, 9.576641]
Trp3['CZ2'] = [56.137118, 32.581375, 9.570389]
Trp3['HZ2'] = [57.083635, 32.969627, 9.165843]
Trp3['CH2'] = [56.051482, 31.313942, 10.087657]
Trp3['HH2'] = [56.947775, 30.675661, 10.097932]
Trp3['CZ3'] = [54.843636, 30.812109, 10.605521]
Trp3['HZ3'] = [54.811091, 29.790007, 11.009532]
Trp3['CE3'] = [53.688807, 31.588636, 10.614512]
Trp3['HE3'] = [52.748354, 31.191173, 11.023998]
Trp3['CD2'] = [53.747362, 32.88841, 10.091192]

Trp4 = OrderedDict()
Trp4['CB'] = [51.342, 33.914, 10.337]
Trp4['CD2'] = [53.747362, 32.88841, 10.091192]
#Trp4['H'] = [11.835, 14.174, 21.993]
Trp4['HA'] = [51.629, 33.217, 12.35]
Trp4['HB2'] = [50.895597, 32.972156, 9.985442]
Trp4['HB3'] = [50.813769, 34.731453, 9.823771]
Trp4['CG'] = [52.789371, 33.944527, 9.936876]
Trp4['CD1'] = [53.629804, 32.874886, 9.818723]
Trp4['HD1'] = [53.346527, 31.829225, 10.006153]
Trp4['NE1'] = [54.880659, 33.293153, 9.43215]
Trp4['HE1'] = [55.669641, 32.698469, 9.277189]
Trp4['CE2'] = [54.87081, 34.656328, 9.294061]
Trp4['CZ2'] = [55.895715, 35.532343, 8.922296]
Trp4['HZ2'] = [56.903881, 35.162749, 8.682937]
Trp4['CH2'] = [55.596906, 36.869865, 8.867193]
Trp4['HH2'] = [56.381615, 37.584641, 8.57706]
Trp4['CZ3'] = [54.309756, 37.348052, 9.172957]
Trp4['HZ3'] = [54.106873, 38.427464, 9.121136]
Trp4['CE3'] = [53.288758, 36.476673, 9.540335]
Trp4['HE3'] = [52.283567, 36.856987, 9.774979]
Trp4['CD2'] = [53.566388, 35.103583, 9.605554]

Trp5 = OrderedDict()
Trp5['CB'] = [51.342, 33.914, 10.337]
Trp5['CD2'] = [53.566388, 35.103583, 9.605554]
#Trp5['H'] = [11.835, 14.174, 21.993]
Trp5['HA'] = [51.629, 33.217, 12.35]
Trp5['HB2'] = [50.752212, 34.683632, 9.81762]
Trp5['HB3'] = [52.401187, 34.122457, 10.124091]
Trp5['CG'] = [50.988927, 32.567949, 9.771844]
Trp5['CD1'] = [51.814569, 31.487, 9.652335]
Trp5['HD1'] = [52.869113, 31.464195, 9.962496]
Trp5['NE1'] = [51.138142, 30.431785, 9.08843]
Trp5['HE1'] = [51.52469, 29.529209, 8.898452]
Trp5['CE2'] = [49.849233, 30.817475, 8.828871]
Trp5['CZ2'] = [48.789906, 30.100184, 8.26375]
Trp5['HZ2'] = [48.913749, 29.05413, 7.946377]
Trp5['CH2'] = [47.590459, 30.749754, 8.119981]
Trp5['HH2'] = [46.737273, 30.212257, 7.679502]
Trp5['CZ3'] = [47.426699, 32.087438, 8.523336]
Trp5['HZ3'] = [46.451439, 32.577443, 8.390146]
Trp5['CE3'] = [48.479594, 32.800914, 9.0882]
Trp5['HE3'] = [48.343783, 33.845728, 9.404466]
Trp5['CD2'] = [49.717734, 32.161662, 9.246545]

Trp6 = OrderedDict()
Trp6['CB'] = [51.342, 33.914, 10.337]
Trp6['CD2'] = [49.717734, 32.161662, 9.246545]
#Trp6['H'] = [11.835, 14.174, 21.993]
Trp6['HA'] = [51.629, 33.217, 12.35]
Trp6['HB2'] = [50.752212, 34.683632, 9.81762]
Trp6['HB3'] = [52.401187, 34.122457, 10.124091]
Trp6['CG'] = [50.988927, 32.567949, 9.771844]
Trp6['CD1'] = [50.586516, 31.46575, 10.470156]
Trp6['HD1'] = [50.466824, 31.422659, 11.562219]
Trp6['NE1'] = [50.352883, 30.417976, 9.611897]
Trp6['HE1'] = [50.048441, 29.504055, 9.880629]
Trp6['CE2'] = [50.605047, 30.828952, 8.329351]
Trp6['CZ2'] = [50.511369, 30.127616, 7.122954]
Trp6['HZ2'] = [50.192855, 29.074901, 7.097801]
Trp6['CH2'] = [50.831479, 30.801485, 5.971991]
Trp6['HH2'] = [50.766923, 30.277564, 5.006491]
Trp6['CZ3'] = [51.240079, 32.147315, 5.998369]
Trp6['HZ3'] = [51.491948, 32.655103, 5.056195]
Trp6['CE3'] = [51.330916, 32.846557, 7.198167]
Trp6['HE3'] = [51.647979, 33.899839, 7.211338]
Trp6['CD2'] = [51.010147, 32.18199, 8.390712]

Trp7 = OrderedDict()
Trp7['CB'] = [51.342, 33.914, 10.337]
Trp7['CD2'] = [51.010147, 32.18199, 8.390712]
#Trp7['H'] = [11.835, 14.174, 21.993]
Trp7['HA'] = [51.629, 33.217, 12.35]
Trp7['HB2'] = [50.752212, 34.683632, 9.81762]
Trp7['HB3'] = [52.401187, 34.122457, 10.124091]
Trp7['CG'] = [50.988927, 32.567949, 9.771844]
Trp7['CD1'] = [49.807934, 32.208038, 9.188631]
Trp7['HD1'] = [48.943876, 32.874684, 9.055323]
Trp7['NE1'] = [49.854404, 30.892771, 8.792479]
Trp7['HE1'] = [49.113615, 30.396096, 8.340042]
Trp7['CE2'] = [51.079676, 30.373201, 9.118313]
Trp7['CZ2'] = [51.59607, 29.0887, 8.919725]
Trp7['HZ2'] = [50.999931, 28.302685, 8.432805]
Trp7['CH2'] = [52.873897, 28.845447, 9.35478]
Trp7['HH2'] = [53.309131, 27.844893, 9.212259]
Trp7['CZ3'] = [53.640373, 29.846521, 9.9787]
Trp7['HZ3'] = [54.660419, 29.614939, 10.317601]
Trp7['CE3'] = [53.128133, 31.125621, 10.174192]
Trp7['HE3'] = [53.734112, 31.904735, 10.659864]
Trp7['CD2'] = [51.823743, 31.402191, 9.739703]

# Arginine (34 conforms)
# conform 1: chi = [62, 180, 65, 85]
Arg1 = OrderedDict()
Arg1['CB'] = [69.551000, 12.987000, 9.783000]
#Arg1['H'] = [11.835000, 14.174000, 21.993000]
Arg1['HA'] = [70.354000, 14.977000, 9.522000]
Arg1['HB2'] = [70.089644, 12.600125, 8.905544]
Arg1['HB3'] = [70.183466, 12.790370, 10.660755]
Arg1['CG'] = [68.238928, 12.224681, 9.935762]
Arg1['HG2'] = [67.696526, 12.603347, 10.815119]
Arg1['HG3'] = [67.602686, 12.413110, 9.059130]
Arg1['CD'] = [68.462550, 10.725891, 10.085886]
Arg1['HD2'] = [67.493371, 10.205614, 10.078133]
Arg1['HD3'] = [69.036997, 10.350002, 9.226160]
Arg1['NE'] = [69.175294, 10.417673, 11.325681]
Arg1['HE'] = [70.168949, 10.316770, 11.279571]
Arg1['CZ'] = [68.589803, 10.262951, 12.510083]
Arg1['NH1'] = [67.274207, 10.390443, 12.627557]
Arg1['HH11'] = [66.718993, 10.603431, 11.823359]
Arg1['HH12'] = [66.838136, 10.273126, 13.520008]
Arg1['NH2'] = [69.319864, 9.963713, 13.576631]
Arg1['HH21'] = [70.310380, 9.854208, 13.489813]
Arg1['HH22'] = [68.880098, 9.847503, 14.467315]

# Glutamine (9 conformations)
# conform 1: chi = [62, 180, 20]
Glu1 = OrderedDict()
Glu1['CB'] = [38.737000, 100.859000, 74.718000]
#Glu1['H'] = [11.835000, 14.174000, 21.993000]
Glu1['HA'] = [38.932000, 98.972000, 75.739000]
Glu1['HB2'] = [37.838065, 100.525037, 74.178918]
Glu1['HB3'] = [38.393833, 101.371850, 75.629069]
Glu1['CG'] = [39.491111, 101.852438, 73.849270]
Glu1['HG2'] = [40.389705, 102.193323, 74.384271]
Glu1['HG3'] = [39.834311, 101.347465, 72.934224]
Glu1['CD'] = [38.647572, 103.053779, 73.471264]
Glu1['OE1'] = [37.646017, 103.353021, 74.120595]
Glu1['NE2'] = [39.050750, 103.750703, 72.414532]
Glu1['HE21'] = [38.533806, 104.553747, 72.117900]
Glu1['HE22'] = [39.870926, 103.472219, 71.914884]

# calculates Euclid distance between CB and all atoms for a single amino acid identity
def Euclid_Distance(AminoAcid):

    dist = 0
    longest = "temp"

    CBx = AminoAcid['CB'][0]
    CBy = AminoAcid['CB'][1]
    CBz = AminoAcid['CB'][2]

    for coord in AminoAcid:
        Ax = AminoAcid[coord][0]
        Ay = AminoAcid[coord][1]
        Az = AminoAcid[coord][2]

        diffx = (CBx - Ax) * (CBx - Ax)
        diffy = (CBy - Ay) * (CBy - Ay)
        diffz = (CBz - Az) * (CBz - Az)

        answer = abs(math.sqrt(diffx + diffy + diffz))
        AminoAcid[coord].append(answer)

        if answer > dist:
            dist = answer
            longest = coord
    print("Amino Acid CB greatest distance is " + str(dist) + " from " + longest)

print("Phe (test): ")
Euclid_Distance(Phe)

print("Trp conform 1: ")
Euclid_Distance(Trp1)

print("Trp conform 2: ")
Euclid_Distance(Trp2)

print("Trp conform 3: ")
Euclid_Distance(Trp3)

print("Trp conform 4: ")
Euclid_Distance(Trp4)

print("Trp conform 5: ")
Euclid_Distance(Trp5)

print("Trp conform 6: ")
Euclid_Distance(Trp6)

print("Trp conform 7: ")
Euclid_Distance(Trp7)

print("Arg conform 1: ")
Euclid_Distance(Arg1)

print("Glu conform 1: ")
Euclid_Distance(Glu1)